import React, { useState, useRef } from ‚Äòreact‚Äô;
import { Heart, Bookmark, MessageCircle, Share2, FileText, Image, Mic, X, Plus, MoreVertical } from ‚Äòlucide-react‚Äô;

const EducationalSocialFeed = () => {
const [theme, setTheme] = useState(‚Äòdark‚Äô);
const [menuOpen, setMenuOpen] = useState(false);
const [posts, setPosts] = useState([
{
id: 1,
author: { name: ‚ÄòDr. Sarah Chen‚Äô, avatar: ‚Äòhttps://api.dicebear.com/7.x/avataaars/svg?seed=Sarah‚Äô, role: ‚ÄòProfessor‚Äô },
timestamp: ‚Äò2 hours ago‚Äô,
content: ‚ÄòUnderstanding cardiac physiology is crucial. Here's a comprehensive guide on the electrical conduction system of the heart.‚Äô,
media: { type: ‚Äòimage‚Äô, url: ‚Äòhttps://picsum.photos/600/400?random=1‚Äô },
attachments: [{ type: ‚Äòpdf‚Äô, name: ‚Äòcardiac_conduction.pdf‚Äô, size: ‚Äò2.4 MB‚Äô }],
likes: 234,
comments: 45,
saved: false,
liked: false,
tags: [‚ÄòCardiology‚Äô, ‚ÄòPhysiology‚Äô]
},
{
id: 2,
author: { name: ‚ÄòDr. James Wilson‚Äô, avatar: ‚Äòhttps://api.dicebear.com/7.x/avataaars/svg?seed=James‚Äô, role: ‚ÄòResearcher‚Äô },
timestamp: ‚Äò5 hours ago‚Äô,
content: ‚ÄòNew findings in neuroplasticity research! Listen to my summary of the latest journal publication.‚Äô,
media: { type: ‚Äòaudio‚Äô, url: ‚Äòaudio.mp3‚Äô, duration: ‚Äò5:32‚Äô },
attachments: [],
likes: 189,
comments: 28,
saved: false,
liked: false,
tags: [‚ÄòNeuroscience‚Äô, ‚ÄòResearch‚Äô]
},
{
id: 3,
author: { name: ‚ÄòDr. Maya Patel‚Äô, avatar: ‚Äòhttps://api.dicebear.com/7.x/avataaars/svg?seed=Maya‚Äô, role: ‚ÄòMedical Student‚Äô },
timestamp: ‚Äò1 day ago‚Äô,
content: ‚ÄòQuick study tips for anatomy finals! Breaking down the brachial plexus in a way that actually makes sense.‚Äô,
media: { type: ‚Äòimage‚Äô, url: ‚Äòhttps://picsum.photos/600/400?random=2‚Äô },
attachments: [
{ type: ‚Äòpdf‚Äô, name: ‚Äòbrachial_plexus_notes.pdf‚Äô, size: ‚Äò1.8 MB‚Äô },
{ type: ‚Äòpdf‚Äô, name: ‚Äòpractice_questions.pdf‚Äô, size: ‚Äò890 KB‚Äô }
],
likes: 567,
comments: 93,
saved: false,
liked: false,
tags: [‚ÄòAnatomy‚Äô, ‚ÄòStudy Tips‚Äô]
}
]);
const [newPostModal, setNewPostModal] = useState(false);
const [newPost, setNewPost] = useState({ content: ‚Äò‚Äô, media: null, attachments: [] });
const fileInputRef = useRef(null);
const audioInputRef = useRef(null);
const pdfInputRef = useRef(null);

const toggleTheme = () => setTheme(theme === ‚Äòdark‚Äô ? ‚Äòlight‚Äô : ‚Äòdark‚Äô);

const handleLike = (postId) => {
setPosts(posts.map(post =>
post.id === postId
? { ‚Ä¶post, liked: !post.liked, likes: post.liked ? post.likes - 1 : post.likes + 1 }
: post
));
};

const handleSave = (postId) => {
setPosts(posts.map(post =>
post.id === postId
? { ‚Ä¶post, saved: !post.saved }
: post
));
};

const handleMediaUpload = (e, type) => {
const file = e.target.files[0];
if (!file) return;

```
const reader = new FileReader();
reader.onload = (event) => {
  if (type === 'image') {
    setNewPost({ ...newPost, media: { type: 'image', url: event.target.result } });
  } else if (type === 'audio') {
    setNewPost({ ...newPost, media: { type: 'audio', url: event.target.result, duration: '0:00' } });
  }
};
reader.readAsDataURL(file);
```

};

const handlePdfUpload = (e) => {
const files = Array.from(e.target.files);
const newAttachments = files.map(file => ({
type: ‚Äòpdf‚Äô,
name: file.name,
size: `${(file.size / 1024 / 1024).toFixed(1)} MB`
}));
setNewPost({ ‚Ä¶newPost, attachments: [‚Ä¶newPost.attachments, ‚Ä¶newAttachments] });
};

const removeAttachment = (index) => {
setNewPost({
‚Ä¶newPost,
attachments: newPost.attachments.filter((_, i) => i !== index)
});
};

const createPost = () => {
if (!newPost.content.trim()) return;

```
const post = {
  id: posts.length + 1,
  author: { name: 'You', avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=You', role: 'Student' },
  timestamp: 'Just now',
  content: newPost.content,
  media: newPost.media,
  attachments: newPost.attachments,
  likes: 0,
  comments: 0,
  saved: false,
  liked: false,
  tags: []
};

setPosts([post, ...posts]);
setNewPost({ content: '', media: null, attachments: [] });
setNewPostModal(false);
```

};

const bgColor = theme === ‚Äòdark‚Äô ? ‚Äò#0f0f0f‚Äô : ‚Äò#f5f5f5‚Äô;
const cardBg = theme === ‚Äòdark‚Äô ? ‚Äò#181818‚Äô : ‚Äò#fff‚Äô;
const textColor = theme === ‚Äòdark‚Äô ? ‚Äò#fff‚Äô : ‚Äò#111‚Äô;
const mutedColor = theme === ‚Äòdark‚Äô ? ‚Äò#888‚Äô : ‚Äò#666‚Äô;
const borderColor = theme === ‚Äòdark‚Äô ? ‚Äò#333‚Äô : ‚Äò#ddd‚Äô;
const hoverBg = theme === ‚Äòdark‚Äô ? ‚Äò#222‚Äô : ‚Äò#f0f0f0‚Äô;

return (
<div style={{ minHeight: ‚Äò100vh‚Äô, backgroundColor: bgColor, color: textColor, fontFamily: ‚ÄòArial, sans-serif‚Äô }}>
{/* Header */}
<div style={{ position: ‚Äòsticky‚Äô, top: 0, backgroundColor: cardBg, borderBottom: `1px solid ${borderColor}`, zIndex: 100 }}>
<div style={{ display: ‚Äòflex‚Äô, alignItems: ‚Äòcenter‚Äô, justifyContent: ‚Äòspace-between‚Äô, padding: ‚Äò12px 20px‚Äô, maxWidth: ‚Äò1200px‚Äô, margin: ‚Äò0 auto‚Äô }}>
<div style={{ display: ‚Äòflex‚Äô, alignItems: ‚Äòcenter‚Äô, gap: ‚Äò12px‚Äô }}>
<div style={{ width: ‚Äò40px‚Äô, height: ‚Äò40px‚Äô, background: ‚Äòlinear-gradient(135deg, #667eea 0%, #764ba2 100%)‚Äô, borderRadius: ‚Äò8px‚Äô, display: ‚Äòflex‚Äô, alignItems: ‚Äòcenter‚Äô, justifyContent: ‚Äòcenter‚Äô, fontWeight: ‚Äòbold‚Äô, fontSize: ‚Äò20px‚Äô }}>P</div>
<span style={{ fontSize: ‚Äò20px‚Äô, fontWeight: ‚Äòbold‚Äô }}>Patholytica</span>
</div>

```
      <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
        <button onClick={toggleTheme} style={{ padding: '8px 16px', borderRadius: '6px', border: `1px solid ${borderColor}`, background: cardBg, color: textColor, cursor: 'pointer' }}>
          {theme === 'dark' ? '‚òÄÔ∏è' : 'üåô'}
        </button>
        <div style={{ position: 'relative' }}>
          <button onClick={() => setMenuOpen(!menuOpen)} style={{ padding: '8px', background: 'transparent', border: 'none', cursor: 'pointer', color: textColor }}>
            <MoreVertical size={24} />
          </button>
          {menuOpen && (
            <div style={{ position: 'absolute', top: '100%', right: 0, marginTop: '8px', background: cardBg, border: `1px solid ${borderColor}`, borderRadius: '8px', minWidth: '200px', boxShadow: '0 4px 12px rgba(0,0,0,0.3)' }}>
              {['Profile', 'Settings', 'Help', 'Logout'].map(item => (
                <div key={item} style={{ padding: '12px 16px', cursor: 'pointer', borderBottom: `1px solid ${borderColor}`, transition: 'all 0.2s' }} onMouseOver={(e) => e.currentTarget.style.background = hoverBg} onMouseOut={(e) => e.currentTarget.style.background = 'transparent'}>
                  {item}
                </div>
              ))}
            </div>
          )}
        </div>
      </div>
    </div>
  </div>

  {/* Main Content */}
  <div style={{ maxWidth: '800px', margin: '0 auto', padding: '20px' }}>
    {/* Create Post Button */}
    <button onClick={() => setNewPostModal(true)} style={{ width: '100%', padding: '16px', background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', color: '#fff', border: 'none', borderRadius: '12px', fontSize: '16px', fontWeight: 'bold', cursor: 'pointer', marginBottom: '24px', display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '8px' }}>
      <Plus size={20} /> Create Educational Post
    </button>

    {/* Posts Feed */}
    {posts.map(post => (
      <div key={post.id} style={{ background: cardBg, borderRadius: '12px', marginBottom: '20px', border: `1px solid ${borderColor}`, overflow: 'hidden' }}>
        {/* Post Header */}
        <div style={{ padding: '16px', display: 'flex', alignItems: 'center', gap: '12px' }}>
          <img src={post.author.avatar} alt={post.author.name} style={{ width: '48px', height: '48px', borderRadius: '50%' }} />
          <div style={{ flex: 1 }}>
            <div style={{ fontWeight: 'bold', fontSize: '15px' }}>{post.author.name}</div>
            <div style={{ fontSize: '13px', color: mutedColor }}>{post.author.role} ‚Ä¢ {post.timestamp}</div>
          </div>
        </div>

        {/* Post Content */}
        <div style={{ padding: '0 16px 16px' }}>
          <p style={{ margin: '0 0 12px', lineHeight: '1.5' }}>{post.content}</p>
          
          {/* Tags */}
          {post.tags && post.tags.length > 0 && (
            <div style={{ display: 'flex', gap: '8px', marginBottom: '12px', flexWrap: 'wrap' }}>
              {post.tags.map(tag => (
                <span key={tag} style={{ padding: '4px 12px', background: theme === 'dark' ? '#2a2a2a' : '#e8e8e8', borderRadius: '16px', fontSize: '12px', color: mutedColor }}>
                  #{tag}
                </span>
              ))}
            </div>
          )}
        </div>

        {/* Media */}
        {post.media && (
          <div>
            {post.media.type === 'image' && (
              <img src={post.media.url} alt="Post media" style={{ width: '100%', display: 'block' }} />
            )}
            {post.media.type === 'audio' && (
              <div style={{ padding: '0 16px 16px' }}>
                <div style={{ background: theme === 'dark' ? '#2a2a2a' : '#f0f0f0', borderRadius: '12px', padding: '16px', display: 'flex', alignItems: 'center', gap: '12px' }}>
                  <div style={{ width: '48px', height: '48px', borderRadius: '50%', background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                    <Mic size={24} color="#fff" />
                  </div>
                  <div style={{ flex: 1 }}>
                    <div style={{ fontSize: '14px', fontWeight: 'bold', marginBottom: '4px' }}>Voice Recording</div>
                    <div style={{ fontSize: '13px', color: mutedColor }}>Duration: {post.media.duration}</div>
                  </div>
                  <button style={{ padding: '8px 16px', background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', color: '#fff', border: 'none', borderRadius: '6px', cursor: 'pointer', fontSize: '14px' }}>
                    Play
                  </button>
                </div>
              </div>
            )}
          </div>
        )}

        {/* Attachments */}
        {post.attachments && post.attachments.length > 0 && (
          <div style={{ padding: '0 16px 16px' }}>
            {post.attachments.map((attachment, idx) => (
              <div key={idx} style={{ background: theme === 'dark' ? '#2a2a2a' : '#f0f0f0', borderRadius: '8px', padding: '12px', marginBottom: '8px', display: 'flex', alignItems: 'center', gap: '12px' }}>
                <FileText size={24} color="#667eea" />
                <div style={{ flex: 1 }}>
                  <div style={{ fontSize: '14px', fontWeight: '500' }}>{attachment.name}</div>
                  <div style={{ fontSize: '12px', color: mutedColor }}>{attachment.size}</div>
                </div>
                <button style={{ padding: '6px 12px', background: 'transparent', border: `1px solid ${borderColor}`, borderRadius: '6px', cursor: 'pointer', color: textColor, fontSize: '13px' }}>
                  Download
                </button>
              </div>
            ))}
          </div>
        )}

        {/* Post Actions */}
        <div style={{ padding: '12px 16px', borderTop: `1px solid ${borderColor}`, display: 'flex', justifyContent: 'space-around' }}>
          <button onClick={() => handleLike(post.id)} style={{ display: 'flex', alignItems: 'center', gap: '8px', background: 'transparent', border: 'none', color: post.liked ? '#ff4d4d' : textColor, cursor: 'pointer', fontSize: '14px', padding: '8px 16px', borderRadius: '6px', transition: 'all 0.2s' }} onMouseOver={(e) => e.currentTarget.style.background = hoverBg} onMouseOut={(e) => e.currentTarget.style.background = 'transparent'}>
            <Heart size={20} fill={post.liked ? '#ff4d4d' : 'none'} />
            <span>{post.likes}</span>
          </button>
          <button style={{ display: 'flex', alignItems: 'center', gap: '8px', background: 'transparent', border: 'none', color: textColor, cursor: 'pointer', fontSize: '14px', padding: '8px 16px', borderRadius: '6px' }} onMouseOver={(e) => e.currentTarget.style.background = hoverBg} onMouseOut={(e) => e.currentTarget.style.background = 'transparent'}>
            <MessageCircle size={20} />
            <span>{post.comments}</span>
          </button>
          <button onClick={() => handleSave(post.id)} style={{ display: 'flex', alignItems: 'center', gap: '8px', background: 'transparent', border: 'none', color: post.saved ? '#4CAF50' : textColor, cursor: 'pointer', fontSize: '14px', padding: '8px 16px', borderRadius: '6px' }} onMouseOver={(e) => e.currentTarget.style.background = hoverBg} onMouseOut={(e) => e.currentTarget.style.background = 'transparent'}>
            <Bookmark size={20} fill={post.saved ? '#4CAF50' : 'none'} />
            <span>{post.saved ? 'Saved' : 'Save'}</span>
          </button>
          <button style={{ display: 'flex', alignItems: 'center', gap: '8px', background: 'transparent', border: 'none', color: textColor, cursor: 'pointer', fontSize: '14px', padding: '8px 16px', borderRadius: '6px' }} onMouseOver={(e) => e.currentTarget.style.background = hoverBg} onMouseOut={(e) => e.currentTarget.style.background = 'transparent'}>
            <Share2 size={20} />
          </button>
        </div>
      </div>
    ))}
  </div>

  {/* Create Post Modal */}
  {newPostModal && (
    <div style={{ position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, background: 'rgba(0,0,0,0.7)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 1000, padding: '20px' }} onClick={(e) => e.target === e.currentTarget && setNewPostModal(false)}>
      <div style={{ background: cardBg, borderRadius: '16px', maxWidth: '600px', width: '100%', maxHeight: '90vh', overflow: 'auto' }}>
        {/* Modal Header */}
        <div style={{ padding: '20px', borderBottom: `1px solid ${borderColor}`, display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
          <h2 style={{ margin: 0, fontSize: '20px' }}>Create Educational Post</h2>
          <button onClick={() => setNewPostModal(false)} style={{ background: 'transparent', border: 'none', cursor: 'pointer', color: textColor }}>
            <X size={24} />
          </button>
        </div>

        {/* Modal Body */}
        <div style={{ padding: '20px' }}>
          <textarea
            value={newPost.content}
            onChange={(e) => setNewPost({ ...newPost, content: e.target.value })}
            placeholder="Share your knowledge... What would you like to teach today?"
            style={{ width: '100%', minHeight: '120px', padding: '12px', background: theme === 'dark' ? '#2a2a2a' : '#f9f9f9', border: `1px solid ${borderColor}`, borderRadius: '8px', color: textColor, fontSize: '15px', fontFamily: 'inherit', resize: 'vertical' }}
          />

          {/* Media Preview */}
          {newPost.media && (
            <div style={{ marginTop: '16px', position: 'relative' }}>
              {newPost.media.type === 'image' && (
                <div style={{ position: 'relative' }}>
                  <img src={newPost.media.url} alt="Preview" style={{ width: '100%', borderRadius: '8px' }} />
                  <button onClick={() => setNewPost({ ...newPost, media: null })} style={{ position: 'absolute', top: '8px', right: '8px', background: '#000', border: 'none', borderRadius: '50%', width: '32px', height: '32px', display: 'flex', alignItems: 'center', justifyContent: 'center', cursor: 'pointer' }}>
                    <X size={20} color="#fff" />
                  </button>
                </div>
              )}
              {newPost.media.type === 'audio' && (
                <div style={{ background: theme === 'dark' ? '#2a2a2a' : '#f0f0f0', borderRadius: '8px', padding: '16px', display: 'flex', alignItems: 'center', gap: '12px' }}>
                  <Mic size={24} color="#667eea" />
                  <span style={{ flex: 1 }}>Voice recording attached</span>
                  <button onClick={() => setNewPost({ ...newPost, media: null })} style={{ background: 'transparent', border: 'none', cursor: 'pointer', color: textColor }}>
                    <X size={20} />
                  </button>
                </div>
              )}
            </div>
          )}

          {/* Attachments Preview */}
          {newPost.attachments.length > 0 && (
            <div style={{ marginTop: '16px' }}>
              {newPost.attachments.map((att, idx) => (
                <div key={idx} style={{ background: theme === 'dark' ? '#2a2a2a' : '#f0f0f0', borderRadius: '8px', padding: '12px', marginBottom: '8px', display: 'flex', alignItems: 'center', gap: '12px' }}>
                  <FileText size={20} color="#667eea" />
                  <div style={{ flex: 1 }}>
                    <div style={{ fontSize: '14px' }}>{att.name}</div>
                    <div style={{ fontSize: '12px', color: mutedColor }}>{att.size}</div>
                  </div>
                  <button onClick={() => removeAttachment(idx)} style={{ background: 'transparent', border: 'none', cursor: 'pointer', color: textColor }}>
                    <X size={20} />
                  </button>
                </div>
              ))}
            </div>
          )}

          {/* Upload Buttons */}
          <div style={{ marginTop: '16px', display: 'flex', gap: '12px', flexWrap: 'wrap' }}>
            <input ref={fileInputRef} type="file" accept="image/*" onChange={(e) => handleMediaUpload(e, 'image')} style={{ display: 'none' }} />
            <button onClick={() => fileInputRef.current?.click()} style={{ padding: '10px 16px', background: theme === 'dark' ? '#2a2a2a' : '#f0f0f0', border: `1px solid ${borderColor}`, borderRadius: '8px', cursor: 'pointer', color: textColor, display: 'flex', alignItems: 'center', gap: '8px', fontSize: '14px' }}>
              <Image size={18} /> Add Image
            </button>
            
            <input ref={audioInputRef} type="file" accept="audio/*" onChange={(e) => handleMediaUpload(e, 'audio')} style={{ display: 'none' }} />
            <button onClick={() => audioInputRef.current?.click()} style={{ padding: '10px 16px', background: theme === 'dark' ? '#2a2a2a' : '#f0f0f0', border: `1px solid ${borderColor}`, borderRadius: '8px', cursor: 'pointer', color: textColor, display: 'flex', alignItems: 'center', gap: '8px', fontSize: '14px' }}>
              <Mic size={18} /> Add Audio
            </button>
            
            <input ref={pdfInputRef} type="file" accept=".pdf" multiple onChange={handlePdfUpload} style={{ display: 'none' }} />
            <button onClick={() => pdfInputRef.current?.click()} style={{ padding: '10px 16px', background: theme === 'dark' ? '#2a2a2a' : '#f0f0f0', border: `1px solid ${borderColor}`, borderRadius: '8px', cursor: 'pointer', color: textColor, display: 'flex', alignItems: 'center', gap: '8px', fontSize: '14px' }}>
              <FileText size={18} /> Add PDF
            </button>
          </div>
        </div>

        {/* Modal Footer */}
        <div style={{ padding: '20px', borderTop: `1px solid ${borderColor}`, display: 'flex', justifyContent: 'flex-end', gap: '12px' }}>
          <button onClick={() => setNewPostModal(false)} style={{ padding: '10px 24px', background: 'transparent', border: `1px solid ${borderColor}`, borderRadius: '8px', cursor: 'pointer', color: textColor, fontSize: '14px' }}>
            Cancel
          </button>
          <button onClick={createPost} disabled={!newPost.content.trim()} style={{ padding: '10px 24px', background: newPost.content.trim() ? 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' : mutedColor, color: '#fff', border: 'none', borderRadius: '8px', cursor: newPost.content.trim() ? 'pointer' : 'not-allowed', fontSize: '14px', fontWeight: 'bold' }}>
            Post
          </button>
        </div>
      </div>
    </div>
  )}

  {/* Footer */}
  <footer style={{ marginTop: '40px', padding: '20px', textAlign: 'center', fontSize: '13px', color: mutedColor, borderTop: `1px solid ${borderColor}` }}>
    ¬© 2025 Patholytica by MedicineBank. All rights reserved.
    <br />
    <a href="#" style={{ color: mutedColor, textDecoration: 'none', margin: '0 8px' }}>Privacy Policy</a> |
    <a href="#" style={{ color: mutedColor, textDecoration: 'none', margin: '0 8px' }}>Terms of Service</a> |
    <a href="#" style={{ color: mutedColor, textDecoration: 'none', margin: '0 8px' }}>Contact</a>
  </footer>
</div>
```

);
};

export default EducationalSocialFeed;